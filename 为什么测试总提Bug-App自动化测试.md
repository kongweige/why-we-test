# 为什么测试总提Bug-App自动化测试

这篇文章可能更偏向于测试同学，对于非测试同学来说这篇文章并没有很大的阅读价值，了解过app自动化的同学可能第一时间就能想到Appium、Uiautomator2、PyAutoGui、Airtest亦或者是其他框架等，其实随着我个人工作下来的一个感受这些框架都只是工具用于扩展我们测试的能力边界，如果有使用过其中一个框架那么其他的框架看一下文档实际上手用一下就会了，就算没使用过其中任何一个框架有编程经验几天或者一个星期其实就能上手了（ps:不要过度关注框架的使用收益并不大），所以对于这些框架和工具的详细使用已经有很多文章或者视频讲多了，也秉着让点开这篇文章的非测试同学不白来的想法，这篇文章会以Appium为主要内容从Appium的关键使用方法、基于PO模式演示实际的自动化测试案例、Appium的原理及源码分析、Uiautomator2、App结构反编译、App端代码Mock和Hook几个方向简单聊一聊。


## 1. 自动化测试的价值
对于自动化测试的价值最直观的就是有下面两个方面效率和质量：

* 提高效率： 与CI/CD/DevOps结合融入到企业内部的迭代流水线，将原本复杂的测试流程抽离出来，开发解决了个bug提了PR通过CI/CD的方式自动构建、自动回归执行，提高测试效率

* 提高质量：通过自动化可以在一定程度上避免人工误处理或者漏测的情况，也可以分布式的测试不同机型进行兼容性测试的扩展、专项非功能测试，压力测试等

## 2. Appium

对于测试框架其实大同小异，对于我们测试人员来说需要做到的是，在众多测试框架中根据不同的项目类型选择适合当前项目的测试框架，快速搭建起适合当前项目的质量保障体系

### 2.1 Appium是什么
让Ai帮忙总结了一下，Appium的特性如下表格所示：
| 特性                     | 说明                                                                 |
|--------------------------|----------------------------------------------------------------------|
| **跨平台**               | 一套代码可同时测试 iOS Android Windows等设备                              |
| **支持多种语言**         | 支持 Java、Python、JavaScript 等主流语言                  |
| **应用类型广泛**         | 支持原生应用（Native）、混合应用（Hybrid）和移动 Web 应用           |
| **丰富的生态**           | 有大量客户端库、插件、工具支持，社区活跃                            |                                      |

### 2.2 Appium关键用法

#### 2.2.1 Appium原理
  <img width="811" height="1120" alt="image" src="https://github.com/user-attachments/assets/f4b3df1b-feb9-420b-a0ee-547eed9f7dce" />

* Client 端：将与 Appium 的各种交互封装为可被调用的 API 或工具，如此一来使用者就可以通过 Inspector 或者 Java/Python/其他语言的 Appium 第三库对 Appium Server 进行调用;
* Server 端：起到了信息中转的作用。启动了一个 HTTP 服务，如此就可以接收Client 客户端的请求信息。除此之外，会将所有的控制命令，比如：Adb 命令，自动化的控制命令等其他命令转发到被测应用的移动端上面;
* 移动端：真正执行自动化测试的地方;

* 运行原理如下：

  * 客户端运行脚本的时候，调用任何的appiumAPI，都会向Appium Server端post一条HTTP请求，请求内容就是根据webdriver wire protocol协议规定的一条JSON格式的数据；

  * 当开启appium服务器的同时就开启了监听端口，Appium Server端接收到请求后，解析出JSON数据并发送到手机端；

  * 手机端上已经由BootStrap.jar(iOS为BootStrip.js)开启的socket服务器监听相应的端口，BootStrap.jar在appium每个session第一次访问手机端的时候会自动安装；

  * 手机端接收到对应的请求后，通过BootStrap.jar翻译成UIAutomator能执行的命令，然后通过UIAutomator处理并操作APP完成测试；
  
#### 2.2.2 capability配置
对于Appium的环境配置因为资料比较多就不额外展开说了（提一个注意事项网上好多资料都让安装Appium GUI这个是1.x版本官方已经停止了，Appium 1 所有可用的驱动程序与主Appium服务同时安装，而对于2.x以上的版本将驱动程序拆出Appium的安装，这样Appium的服务安装会更加的轻便。用户可根据自己的需求安装相应的驱动程序）。

好了那我们已经配置好Appium了后要写test script


#### 2.2.3 控件定位方式


#### 2.2.4 等待方式


#### 2.2.5 元素定位方法


讲一下脚本执行和调用的原理，之后直接说capability配置、控件定位方式、等待方式、元素定位方法、

## 3. 基于PO模式的实际测试场景


## Appium源码刨析


## Uiautomator2


## App结构反编译


## App端代码Mock和Hook
















